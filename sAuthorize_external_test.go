package packages

import (
	"testing"

	"gitlab.com/soteapps/packages/v2020/sAuthorize"
	"gitlab.com/soteapps/packages/v2020/sConfigParams"
	"gitlab.com/soteapps/packages/v2020/sError"
)

const (
	TESTTOKENEXPIRED = "eyJraWQiOiJjbmhHanQwVXNqZFNHNzFvUWQ1cThTRjNTb29mOHBPNU1qTThMaDdNWDlrPSIsImFsZyI6IlJTMjU2In0.eyJzdWIiOiJkZDg5NmVhNi03NmI2LTQ1OGYtYWYyNC0zMTAyN2JiOGQzODMiLCJkZXZpY2Vfa2V5IjoiZXUtd2VzdC0xX2YwMzQzZTkwLTA5ZTgtNDA1ZS1hN2FiLWM2MjFkYmMzYzlkNiIsImV2ZW50X2lkIjoiYTg0ZjU4ZTUtZWE2Ni00NjI4LWFmZmItMGUyZmMzNGFiYzE4IiwidG9rZW5fdXNlIjoiYWNjZXNzIiwic2NvcGUiOiJhd3MuY29nbml0by5zaWduaW4udXNlci5hZG1pbiIsImF1dGhfdGltZSI6MTU5NDg1MTc1MCwiaXNzIjoiaHR0cHM6XC9cL2NvZ25pdG8taWRwLmV1LXdlc3QtMS5hbWF6b25hd3MuY29tXC9ldS13ZXN0LTFfUVZQd3dDZzJjIiwiZXhwIjoxNTk0ODU1MzUwLCJpYXQiOjE1OTQ4NTE3NTAsImp0aSI6ImU1YjA5NzI1LWNkNmUtNDczOS1iNzhlLTQxN2MwMDRlOWU3YyIsImNsaWVudF9pZCI6InR0c21yNjUzcXRma3VjZ2dvZnBtcWJic3AiLCJ1c2VybmFtZSI6ImRkODk2ZWE2LTc2YjYtNDU4Zi1hZjI0LTMxMDI3YmI4ZDM4MyJ9.Wdg-p3nBNKk_zBBHB8-Whld_AXqLfuRj7CemOhW5QpkHFPqxx3DNpVodTYQOPiJ0yf2dYh8Hl9ZDZg3SFUf18nFbPCq5OCSbEAPN7zWnS_-zsWmHp9p3TqYH0KenLyEyXoVknQ-212_irZH_DlH3DCX_0CL1IIEVqxlWm7NalB1PeEZbxZtv9lMVue_AS-lavDvMn34nKoxNsnXIVq3EP-oUBR2nIfVUBebEKbTTIbct7WWAltu-QWyXHxhjwpQlDAUv0BW8c1oeoDQU8d1cAYas57IKVpbJk1LgSw73brgLXX_TynNS587oApfMzcbadjTvKarIqPyU3vWReht3JA"
	TESTTOKENNOKID   = "eyJraWQiOiJlOCt4TW4rOGYrZmlIXC9OZDNDZGNxOVRvU3FPKzdZYldcL1wvSUxCYVJyTElNPSIsImFsZyI6IlJTMj.eyJzdWIiOiI1ZDUxNDdlMi01N2ZjLTQ4YTYtYjQ5My0xNzgzOTMxYWU5YzAiLCJkZXZpY2Vfa2V5IjoiZXUtd2VzdC0xXzE0MTVhZTE5LWI4MjYtNDE0YS04NjdlLWNhYWRhMTMxMTAyMSIsImV2ZW50X2lkIjoiNWJiMmMyMDAtYTVhNS00YTU3LWE4NGUtZWQ4Mjg2Yjg1ZGYzIiwidG9rZW5fdXNlIjoiYWNjZXNzIiwic2NvcGUiOiJhd3MuY29nbml0by5zaWduaW4udXNlci5hZG1pbiIsImF1dGhfdGltZSI6MTU5NDc2NDgzMSwiaXNzIjoiaHR0cHM6XC9cL2NvZ25pdG8taWRwLmV1LXdlc3QtMS5hbWF6b25hd3MuY29tXC9ldS13ZXN0LTFfZnBaQ3lxbFFOIiwiZXhwIjoxNTk0NzY4NDMxLCJpYXQiOjE1OTQ3NjQ4MzEsImp0aSI6ImM4Y2NjOGVmLTAyMjQtNGM5Ni05NzRkLTc0NzI0OGNjOGRjOSIsImNsaWVudF9pZCI6IjQ5ZzUwOGgwanIyczJ0bmJpM2toZ3Rkc3AyIiwidXNlcm5hbWUiOiI1ZDUxNDdlMi01N2ZjLTQ4YTYtYjQ5My0xNzgzOTMxYWU5YzAifQ.gOI8aF5glNQQzTu--ttjPtoLNyty6kR_975vSjyZ55aiN3fNsZQBKZXZ1vN116RceC3cmGW3jMxHMdG4eJFX-6zW_t0jLjTyRJZ5AS3C-LQUEVtk-RW1t3kfSYK9Kn_x18bLqrg6eTvD7kcXAr1eXfZsDTqQ08xeYN7EXEXZ7HKHv8C-qVHOOzIUo5N78u8ZbHcTf974i-xWqVMCsBFu1FIYbIzM501j5Tc5Z_M7sH6JtGu_s-5zD_KVNvHWdGyhonnGT5VhONRN3ZgQbeNt_F6jOuH4_KxnHJqQamJiTC4eFr12w0abMXYD8eZm3DkUByUCW9i48TtODlmMoTJC6g"
)

func TestValidToken(t *testing.T) {
	var soteErr sError.SoteError
	if soteErr = sAuthorize.ValidToken(sConfigParams.DEVELOPMENT, TESTTOKENEXPIRED); soteErr.ErrCode != 500050 {
		t.Errorf("ValidToken failed: Expected soteErr to be nil: %v", soteErr.ErrCode)
	}
}
